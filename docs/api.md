# API æ–‡æ¡£

åç«¯ API æ¥å£æ–‡æ¡£ï¼ŒåŸºç¡€ URLï¼š`http://localhost:5000/api`

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### è¯·æ±‚é™æµ

| æ¥å£ç±»å‹ | é™åˆ¶ |
|---------|------|
| è®¤è¯æ¥å£ (`/auth/*`) | 5 æ¬¡/15åˆ†é’Ÿ/IP |
| å…¶ä»–æ¥å£ | 100 æ¬¡/15åˆ†é’Ÿ/IP |

è¶…è¿‡é™åˆ¶è¿”å› `429 Too Many Requests`

### è¾“å…¥éªŒè¯

æ‰€æœ‰æ¥å£éƒ½æœ‰ä¸¥æ ¼çš„è¾“å…¥éªŒè¯ï¼ŒéªŒè¯å¤±è´¥è¿”å›ï¼š
```json
{
  "error": "è¾“å…¥éªŒè¯å¤±è´¥",
  "details": [
    { "field": "email", "message": "è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€" }
  ]
}
```

### è®¤è¯æ–¹å¼

ç®¡ç†æ¥å£éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ JWT Tokenï¼š
```
Authorization: Bearer <token>
```

---

## å…¬å¼€æ¥å£

### è·å–æ–‡ç« åˆ—è¡¨

```
GET /posts?page=1&limit=10
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ | éªŒè¯ |
|------|------|------|------|
| page | number | é¡µç  | 1-1000 |
| limit | number | æ¯é¡µæ•°é‡ | 1-100 |

---

### è·å–æ–‡ç« è¯¦æƒ…

```
GET /posts/:slug
```

---

### è·å–éšæœºæ–‡ç« 

```
GET /posts/random
```

**å“åº”ï¼š**
```json
{ "slug": "random-post-slug" }
```

---

### æœç´¢æ–‡ç« 

```
GET /posts/search?q=å…³é”®è¯
```

| å‚æ•° | ç±»å‹ | éªŒè¯ |
|------|------|------|
| q | string | æœ€å¤š 100 å­—ç¬¦ |

---

### è·å–æ ‡ç­¾åˆ—è¡¨

```
GET /tags
```

**è¡Œä¸ºï¼š**
- å·²ç™»å½•ï¼šåªè¿”å›å½“å‰ç”¨æˆ·æ–‡ç« ä½¿ç”¨çš„æ ‡ç­¾
- æœªç™»å½•ï¼šè¿”å›æ‰€æœ‰å…¬å¼€æ–‡ç« çš„æ ‡ç­¾

---

### è·å–æ ‡ç­¾æ–‡ç« 

```
GET /tags/:slug/posts
```

**è¡Œä¸ºï¼š**
- å·²ç™»å½•ï¼šåªè¿”å›å½“å‰ç”¨æˆ·è¯¥æ ‡ç­¾ä¸‹çš„æ–‡ç« 
- æœªç™»å½•ï¼šè¿”å›è¯¥æ ‡ç­¾ä¸‹æ‰€æœ‰å·²å‘å¸ƒæ–‡ç« 

---

### è·å–ç”¨æˆ·èµ„æ–™

```
GET /users/:id
```

---

## è®¤è¯æ¥å£

### ç™»å½•

```
POST /auth/login
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "email": "admin@example.com æˆ– UIDæ•°å­—",
  "password": "å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰"
}
```

**æ”¯æŒä¸¤ç§ç™»å½•æ–¹å¼ï¼š**
- é‚®ç®±ï¼š`user@example.com`
- UIDï¼š`6`ï¼ˆçº¯æ•°å­—ï¼‰

**å“åº”ï¼š**
```json
{
  "success": true,
  "message": "// ACCESS GRANTED",
  "token": "jwt-token...",
  "user": { "id": 1, "email": "...", "name": "...", "role": "USER" },
  "expiresIn": "7 days"
}
```

---

### æ³¨å†Œ

```
POST /auth/register
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "name": "ç”¨æˆ·å",
  "email": "user@example.com",
  "password": "å¯†ç "
}
```

**éªŒè¯è§„åˆ™ï¼š**
| å­—æ®µ | è§„åˆ™ |
|------|------|
| name | 2-30 å­—ç¬¦ï¼Œæ”¯æŒä¸­æ–‡ã€å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ |
| email | æœ‰æ•ˆé‚®ç®±æ ¼å¼ |
| password | 6-100 å­—ç¬¦ï¼Œå¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­— |

---

## ç”¨æˆ·æ¥å£ï¼ˆéœ€ç™»å½•ï¼‰

### æ›´æ–°ä¸ªäººèµ„æ–™

```
PUT /user/profile
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "name": "æ–°ç”¨æˆ·å",
  "bio": "ä¸ªäººç®€ä»‹"
}
```

---

### ä¸Šä¼ å¤´åƒ

```
POST /user/avatar
Content-Type: multipart/form-data
```

---

### ä¸Šä¼ èƒŒæ™¯å›¾

```
POST /user/background
Content-Type: multipart/form-data
```

---

## è¯„è®ºæ¥å£

### å‘è¡¨è¯„è®ºï¼ˆéœ€ç™»å½•ï¼‰

```
POST /comments
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "postId": 1,
  "content": "è¯„è®ºå†…å®¹ï¼ˆ1-1000å­—ç¬¦ï¼‰"
}
```

---

## ç®¡ç†æ¥å£ï¼ˆéœ€ ADMIN+ï¼‰

### è·å–ä»ªè¡¨ç›˜ç»Ÿè®¡

```
GET /admin/stats
```

---

### æ–‡ç« ç®¡ç†

```
GET    /admin/posts          # è·å–æ‰€æœ‰æ–‡ç« 
GET    /admin/posts/:id      # è·å–å•ç¯‡æ–‡ç« 
POST   /admin/posts          # åˆ›å»ºæ–‡ç« 
PUT    /admin/posts/:id      # æ›´æ–°æ–‡ç« 
DELETE /admin/posts/:id      # åˆ é™¤æ–‡ç« 
```

**åˆ›å»ºæ–‡ç« éªŒè¯ï¼š**
| å­—æ®µ | è§„åˆ™ |
|------|------|
| title | å¿…å¡«ï¼Œ1-200 å­—ç¬¦ |
| content | å¿…å¡«ï¼Œè‡³å°‘ 10 å­—ç¬¦ |
| slug | å¯é€‰ï¼ŒURL æ ¼å¼ |
| excerpt | å¯é€‰ï¼Œæœ€å¤š 500 å­—ç¬¦ |

---

### ä¸Šä¼ æ–‡ä»¶

```
POST /admin/upload
Content-Type: multipart/form-data
```

---

## è¶…çº§ç®¡ç†å‘˜æ¥å£ï¼ˆéœ€ SUPER_ADMINï¼‰

### ç”¨æˆ·ç®¡ç†

```
GET    /admin/users              # è·å–ç”¨æˆ·åˆ—è¡¨
PUT    /admin/users/:id/role     # ä¿®æ”¹ç”¨æˆ·è§’è‰²
DELETE /admin/users/:id          # åˆ é™¤ç”¨æˆ·
```

**ä¿®æ”¹è§’è‰²è¯·æ±‚ä½“ï¼š**
```json
{
  "role": "USER | ADMIN | SUPER_ADMIN"
}
```

---

## è§’è‰²æƒé™

| è§’è‰² | æƒé™ |
|------|------|
| USER | æµè§ˆã€è¯„è®ºã€ç®¡ç†ä¸ªäººèµ„æ–™ |
| ADMIN | + ç®¡ç†æ–‡ç« ã€æ ‡ç­¾ã€ä¸Šä¼ æ–‡ä»¶ |
| SUPER_ADMIN | + ç®¡ç†ç”¨æˆ·ã€ä¿®æ”¹è§’è‰² |
