# 项目优化与修复总结 (v1.0.1)

本次会话主要解决了环境配置、生产部署、功能缺陷及用户体验优化等一系列问题。以下是详细变更清单：

## 1. 环境与部署修复
### 端口与启动管理
- **新增** `关闭端口.bat`：一键清理占用 3000/5000 端口的进程。
- **修复** `启动博客.bat`：将前端启动命令从 `npx serve` 改为 `npm run dev`，确保 `vite.config.ts` 中的代理配置生效，解决了 API 请求返回 HTML 的问题。

### 生产环境支持 (Formal Environment)
- **后端静态托管**：修改 `backend/src/index.ts`，使其能直接托管前端构建文件 (`frontend/dist`)。
    - **效果**：现在只需启动后端 (端口 5000)，即可访问完整的网站（页面 + API）。
    - **解决**：彻底解决了 FRP 或 Nginx 代理配置不当导致的 API 跨域或 404 问题。
- **数据库连接**：安装 `dotenv` 并在入口文件显式加载，修复了在非开发环境下无法读取 `.env` 导致连不上数据库的问题。

### 域名访问
- **诊断**：确认了 FRP 双隧道配置问题（3000 端口只有页面无 API，5000 端口全功能）。
- **建议**：使用指向 5000 端口的域名 (`bblog.crazzy.cn`) 获得最佳体验。

## 2. 功能修复 (Bug Fixes)
### 修改密码功能
- **后端修复** (`backend/src/controllers/userController.ts`)：
    - 将 `bcryptjs` 的导入方式从动态导入改为**静态导入**，修复了生产环境下“服务暂不可用 (500 Error)”的崩溃问题。
- **前端优化** (`frontend/src/pages/UserProfile.tsx`)：
    - 修复了硬编码的错误提示。现在会显示后端返回的具体错误（如“原密码错误”、“两次输入不一致”等），而不是模糊的“服务不可用”。

## 3. 用户体验优化 (UX)
### 登出逻辑
- **修改**：用户点击“退出登录”后，现在会跳转到**首页 (`/`)**，而不是登录页。
- **自动化**：修改密码成功后，系统会自动弹出提示并**自动登出**，强制用户使用新密码重新登录，增强安全性。

## 4. 版本控制
- **Git 初始化**：初始化了仓库，创建了 `.gitignore`。
- **代码提交**：完成了首次完整提交 (Commit: `Version 1.0.1`)。
- **远程配置**：添加了 GitHub 远程仓库地址 `origin`。
